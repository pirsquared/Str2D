<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>str2d &mdash; Str2D 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=e07f7fc8" />

  
    <link rel="shortcut icon" href="../_static/pirr_logo.svg"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=938c9ccc"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Str2D
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../str2d.html">Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../motivation.html">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Str2D</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">str2d</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for str2d</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Manipulate 2D strings in Python.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span><span class="p">,</span> <span class="n">cached_property</span><span class="p">,</span> <span class="n">lru_cache</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">indent</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">Series</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mpmath</span> <span class="k">as</span> <span class="nn">mp</span>


<div class="viewcode-block" id="BoxParts">
<a class="viewcode-back" href="../str2d.html#str2d.BoxParts">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">BoxParts</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Box parts organizes box drawing characters into attribute names that are short</span>
<span class="sd">    and descriptive. This makes it easier to work with box drawing characters in code.</span>

<span class="sd">    The tables below show the attribute names, examples, and descriptions of the parts.</span>

<span class="sd">    .. _box-parts-doc-table-1:</span>

<span class="sd">    +-------------+-----------+-------------------------------------------+</span>
<span class="sd">    | Attribute   | Example   | Description                               |</span>
<span class="sd">    | Name        | Value     |                                           |</span>
<span class="sd">    +====+===+====+===+===+===+==============+============+===============+</span>
<span class="sd">    | ul | t | ur | ┌ | ┬ | ┐ | | Upper-left | | Top T    | | Upper-right |</span>
<span class="sd">    |    |   |    |   |   |   | | corner     | | cross    | | corner      |</span>
<span class="sd">    +----+---+----+---+---+---+--------------+------------+---------------+</span>
<span class="sd">    | l  | c | r  | ├ | ┼ | ┤ | | Left T     | | Center   | | Right T     |</span>
<span class="sd">    |    |   |    |   |   |   | | cross      | | cross    | | cross       |</span>
<span class="sd">    +----+---+----+---+---+---+--------------+------------+---------------+</span>
<span class="sd">    | ll | b | lr | └ | ┴ | ┘ | | Lower-left | | Bottom T | | Lower-right |</span>
<span class="sd">    |    |   |    |   |   |   | | corner     | | cross    | | corner      |</span>
<span class="sd">    +----+---+----+---+---+---+--------------+------------+---------------+</span>


<span class="sd">    .. _box-parts-doc-table-2:</span>

<span class="sd">    +--------------------+----------+------------+</span>
<span class="sd">    | **Attribute Name** | v        | h          |</span>
<span class="sd">    +--------------------+----------+------------+</span>
<span class="sd">    | **Example Value**  | │        | ─          |</span>
<span class="sd">    +--------------------+----------+------------+</span>
<span class="sd">    | **Description**    | Vertical | Horizontal |</span>
<span class="sd">    +--------------------+----------+------------+</span>

<span class="sd">    You can pass any unicode characters to the BoxParts class and it will categorize</span>
<span class="sd">    them accordingly. But the expectation would be something like the example above.</span>

<span class="sd">    .. testcode::</span>

<span class="sd">        from str2d import BoxParts</span>

<span class="sd">        BoxParts(</span>
<span class="sd">            v=&#39;│&#39;, h=&#39;─&#39;, ul=&#39;┌&#39;, ur=&#39;┐&#39;, lr=&#39;┘&#39;, ll=&#39;└&#39;,</span>
<span class="sd">            l=&#39;├&#39;, r=&#39;┤&#39;, t=&#39;┬&#39;, b=&#39;┴&#39;, c=&#39;┼&#39;</span>
<span class="sd">        )</span>

<span class="sd">    .. testoutput::</span>

<span class="sd">        ┌─┬─┐</span>
<span class="sd">        │ │ │</span>
<span class="sd">        ├─┼─┤</span>
<span class="sd">        │ │ │</span>
<span class="sd">        └─┴─┘</span>

<span class="sd">    Or you can pass the any characters you want to the BoxParts class and it will</span>
<span class="sd">    categorize them accordingly.  In this example we use the unicode character for</span>
<span class="sd">    a full block to be all the box parts.</span>

<span class="sd">    .. testcode::</span>

<span class="sd">        BoxParts(*&quot;█&quot;*11)</span>

<span class="sd">    .. testoutput::</span>

<span class="sd">        █████</span>
<span class="sd">        █ █ █</span>
<span class="sd">        █████</span>
<span class="sd">        █ █ █</span>
<span class="sd">        █████</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">v</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Vertical line</span>
    <span class="n">h</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Horizontal line</span>
    <span class="n">ul</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Upper-left corner</span>
    <span class="n">ur</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Upper-right corner</span>
    <span class="n">lr</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Lower-right corner</span>
    <span class="n">ll</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Lower-left corner</span>
    <span class="n">l</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Left T (cross)</span>
    <span class="n">r</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Right T (cross)</span>
    <span class="n">t</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Top T (cross)</span>
    <span class="n">b</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Bottom T (cross)</span>
    <span class="n">c</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Center cross</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the box parts as a string to illustrate what the box looks like.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ul</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">ur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ll</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the box parts as a string to illustrate what the box looks like.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="BoxParts.to_str2d">
<a class="viewcode-back" href="../str2d.html#str2d.BoxParts.to_str2d">[docs]</a>
    <span class="k">def</span> <span class="nf">to_str2d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the box parts to a Str2D object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">halign</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">valign</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="BoxStyle">
<a class="viewcode-back" href="../str2d.html#str2d.BoxStyle">[docs]</a>
<span class="k">class</span> <span class="nc">BoxStyle</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;BoxStyle is an enumeration of different box styles that can be used to draw</span>
<span class="sd">    boxes around text.  The box styles are made up of BoxParts objects that contain</span>
<span class="sd">    the box drawing characters.  The main purpose of this class is to provide a way</span>
<span class="sd">    to apply box drawing over Str2D objects.</span>

<span class="sd">    You can see all the box styles by calling the swatches method.</span>

<span class="sd">    .. testcode::</span>

<span class="sd">        from str2d import BoxStyle</span>

<span class="sd">        BoxStyle.swatches()</span>

<span class="sd">    .. testoutput::</span>

<span class="sd">                                                        DASHED      DASHED</span>
<span class="sd">                                            DASHED      DOUBLE      DOUBLE</span>
<span class="sd">                    SINGLE      DASHED      DOUBLE      LIGHT       HEAVY</span>
<span class="sd">        SINGLE      HEAVY       DOUBLE      HEAVY       HEAVY       LIGHT</span>
<span class="sd">        ┌─┬─┐       ┏━┳━┓       ┌╌┬╌┐       ┏╍┳╍┓       ┍╍┯╍┑       ┎╌┰╌┒</span>
<span class="sd">        │ │ │       ┃ ┃ ┃       ╎ ╎ ╎       ╏ ╏ ╏       ╎ ╎ ╎       ╏ ╏ ╏</span>
<span class="sd">        ├─┼─┤       ┣━╋━┫       ├╌┼╌┤       ┣╍╋╍┫       ┝╍┿╍┥       ┠╌╂╌┨</span>
<span class="sd">        │ │ │       ┃ ┃ ┃       ╎ ╎ ╎       ╏ ╏ ╏       ╎ ╎ ╎       ╏ ╏ ╏</span>
<span class="sd">        └─┴─┘       ┗━┻━┛       └╌┴╌┘       ┗╍┻╍┛       ┕╍┷╍┙       ┖╌┸╌┚</span>

<span class="sd">                                DASHED      DASHED</span>
<span class="sd">                    DASHED      TRIPLE      TRIPLE                  DASHED</span>
<span class="sd">        DASHED      TRIPLE      LIGHT       HEAVY       DASHED      QUADRUPLE</span>
<span class="sd">        TRIPLE      HEAVY       HEAVY       LIGHT       QUADRUPLE   HEAVY</span>
<span class="sd">        ┌┄┬┄┐       ┏┅┳┅┓       ┍┅┯┅┑       ┎┄┰┄┒       ┌┈┬┈┐       ┏┉┳┉┓</span>
<span class="sd">        ┆ ┆ ┆       ┇ ┇ ┇       ┆ ┆ ┆       ┇ ┇ ┇       ┊ ┊ ┊       ┋ ┋ ┋</span>
<span class="sd">        ├┄┼┄┤       ┣┅╋┅┫       ┝┅┿┅┥       ┠┄╂┄┨       ├┈┼┈┤       ┣┉╋┉┫</span>
<span class="sd">        ┆ ┆ ┆       ┇ ┇ ┇       ┆ ┆ ┆       ┇ ┇ ┇       ┊ ┊ ┊       ┋ ┋ ┋</span>
<span class="sd">        └┄┴┄┘       ┗┅┻┅┛       ┕┅┷┅┙       ┖┄┸┄┚       └┈┴┈┘       ┗┉┻┉┛</span>

<span class="sd">        DASHED      DASHED</span>
<span class="sd">        QUADRUPLE   QUADRUPLE               DASHED      DASHED      DASHED</span>
<span class="sd">        LIGHT       HEAVY       SINGLE      DOUBLE      TRIPLE      QUADRUPLE</span>
<span class="sd">        HEAVY       LIGHT       ROUND       ROUND       ROUND       ROUND</span>
<span class="sd">        ┍┉┯┉┑       ┎┈┰┈┒       ╭─┬─╮       ╭╌┬╌╮       ╭┄┬┄╮       ╭┈┬┈╮</span>
<span class="sd">        ┊ ┊ ┊       ┋ ┋ ┋       │ │ │       ╎ ╎ ╎       ┆ ┆ ┆       ┊ ┊ ┊</span>
<span class="sd">        ┝┉┿┉┥       ┠┈╂┈┨       ├─┼─┤       ├╌┼╌┤       ├┄┼┄┤       ├┈┼┈┤</span>
<span class="sd">        ┊ ┊ ┊       ┋ ┋ ┋       │ │ │       ╎ ╎ ╎       ┆ ┆ ┆       ┊ ┊ ┊</span>
<span class="sd">        ┕┉┷┉┙       ┖┈┸┈┚       ╰─┴─╯       ╰╌┴╌╯       ╰┄┴┄╯       ╰┈┴┈╯</span>

<span class="sd">                    DOUBLE      SINGLE      LIGHT       HEAVY</span>
<span class="sd">        DOUBLE      SINGLE      DOUBLE      HEAVY       LIGHT</span>
<span class="sd">        ╔═╦═╗       ╓─╥─╖       ╒═╤═╕       ┎─┰─┒       ┍━┯━┑</span>
<span class="sd">        ║ ║ ║       ║ ║ ║       │ │ │       ┃ ┃ ┃       │ │ │</span>
<span class="sd">        ╠═╬═╣       ╟─╫─╢       ╞═╪═╡       ┠─╂─┨       ┝━┿━┥</span>
<span class="sd">        ║ ║ ║       ║ ║ ║       │ │ │       ┃ ┃ ┃       │ │ │</span>
<span class="sd">        ╚═╩═╝       ╙─╨─╜       ╘═╧═╛       ┖─┸─┚       ┕━┷━┙</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SINGLE</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;│─┌┐┘└├┤┬┴┼&quot;</span><span class="p">)</span>
    <span class="n">SINGLE_HEAVY</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;┃━┏┓┛┗┣┫┳┻╋&quot;</span><span class="p">)</span>
    <span class="n">DASHED_DOUBLE</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;╎╌┌┐┘└├┤┬┴┼&quot;</span><span class="p">)</span>
    <span class="n">DASHED_DOUBLE_HEAVY</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;╏╍┏┓┛┗┣┫┳┻╋&quot;</span><span class="p">)</span>
    <span class="n">DASHED_DOUBLE_LIGHT_HEAVY</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;╎╍┍┑┙┕┝┥┯┷┿&quot;</span><span class="p">)</span>
    <span class="n">DASHED_DOUBLE_HEAVY_LIGHT</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;╏╌┎┒┚┖┠┨┰┸╂&quot;</span><span class="p">)</span>
    <span class="n">DASHED_TRIPLE</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;┆┄┌┐┘└├┤┬┴┼&quot;</span><span class="p">)</span>
    <span class="n">DASHED_TRIPLE_HEAVY</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;┇┅┏┓┛┗┣┫┳┻╋&quot;</span><span class="p">)</span>
    <span class="n">DASHED_TRIPLE_LIGHT_HEAVY</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;┆┅┍┑┙┕┝┥┯┷┿&quot;</span><span class="p">)</span>
    <span class="n">DASHED_TRIPLE_HEAVY_LIGHT</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;┇┄┎┒┚┖┠┨┰┸╂&quot;</span><span class="p">)</span>
    <span class="n">DASHED_QUADRUPLE</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;┊┈┌┐┘└├┤┬┴┼&quot;</span><span class="p">)</span>
    <span class="n">DASHED_QUADRUPLE_HEAVY</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;┋┉┏┓┛┗┣┫┳┻╋&quot;</span><span class="p">)</span>
    <span class="n">DASHED_QUADRUPLE_LIGHT_HEAVY</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;┊┉┍┑┙┕┝┥┯┷┿&quot;</span><span class="p">)</span>
    <span class="n">DASHED_QUADRUPLE_HEAVY_LIGHT</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;┋┈┎┒┚┖┠┨┰┸╂&quot;</span><span class="p">)</span>
    <span class="n">SINGLE_ROUND</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;│─╭╮╯╰├┤┬┴┼&quot;</span><span class="p">)</span>
    <span class="n">DASHED_DOUBLE_ROUND</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;╎╌╭╮╯╰├┤┬┴┼&quot;</span><span class="p">)</span>
    <span class="n">DASHED_TRIPLE_ROUND</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;┆┄╭╮╯╰├┤┬┴┼&quot;</span><span class="p">)</span>
    <span class="n">DASHED_QUADRUPLE_ROUND</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;┊┈╭╮╯╰├┤┬┴┼&quot;</span><span class="p">)</span>
    <span class="n">DOUBLE</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;║═╔╗╝╚╠╣╦╩╬&quot;</span><span class="p">)</span>
    <span class="n">DOUBLE_SINGLE</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;║─╓╖╜╙╟╢╥╨╫&quot;</span><span class="p">)</span>
    <span class="n">SINGLE_DOUBLE</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;│═╒╕╛╘╞╡╤╧╪&quot;</span><span class="p">)</span>
    <span class="n">LIGHT_HEAVY</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;┃─┎┒┚┖┠┨┰┸╂&quot;</span><span class="p">)</span>
    <span class="n">HEAVY_LIGHT</span> <span class="o">=</span> <span class="n">BoxParts</span><span class="p">(</span><span class="o">*</span><span class="s2">&quot;│━┍┑┙┕┝┥┯┷┿&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="BoxStyle.to_str2d">
<a class="viewcode-back" href="../str2d.html#str2d.BoxStyle.to_str2d">[docs]</a>
    <span class="k">def</span> <span class="nf">to_str2d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the box style to a Str2D object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">to_str2d</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the box style as a string to illustrate what the box looks like.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_str2d</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the box style as a string to illustrate what the box looks like.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="BoxStyle.swatches">
<a class="viewcode-back" href="../str2d.html#str2d.BoxStyle.swatches">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">swatches</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a Str2D object with the box style swatches.&quot;&quot;&quot;</span>

        <span class="n">master_box_list</span> <span class="o">=</span> <span class="n">Str2D</span><span class="o">.</span><span class="n">equal_width</span><span class="p">(</span>
            <span class="o">*</span><span class="p">[</span><span class="n">value</span><span class="o">.</span><span class="n">to_str2d</span><span class="p">()</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__members__</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        <span class="p">)</span>

        <span class="n">master_matrix</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">row</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">master_box_list</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">6</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">master_matrix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">Str2D</span><span class="o">.</span><span class="n">join_v</span><span class="p">(</span>
            <span class="o">*</span><span class="p">[</span><span class="n">Str2D</span><span class="o">.</span><span class="n">join_h</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;   &quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">master_matrix</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="n">Str2D</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>
</div>



<div class="viewcode-block" id="Str2D">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D">[docs]</a>
<span class="k">class</span> <span class="nc">Str2D</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Str2D is a class that allows you to manipulate 2D strings in Python.  I had found</span>
<span class="sd">    myself wanting to paste blocks of text inline with other blocks of text.  If you&#39;ve</span>
<span class="sd">    ever tried to do this in a text editor, you&#39;ll know that it can be a bit of a pain.</span>
<span class="sd">    vi and vim have a feature called visual block mode that makes this easier.  But I</span>
<span class="sd">    wanted more flexibility and control.  So I created Str2D.</span>
<span class="sd">    </span>
<span class="sd">    Given a multi-line string, Str2D will convert it into something functionally</span>
<span class="sd">    equivalent where each line separated by a newline character will have the same</span>
<span class="sd">    number of characters.  These are filled in with whatever character is specified but</span>
<span class="sd">    by default it is a space.  This takes care of making sure that each row is the same</span>
<span class="sd">    width and is primed for manipulation.</span>

<span class="sd">    The simplest example is to show how to create a Str2D object from a multi-line</span>
<span class="sd">    string and add it to another Str2D object.</span>

<span class="sd">    Let&#39;s start by constructing a new instance of Str2D and assinging it to the variable</span>
<span class="sd">    `a`.</span>

<span class="sd">    .. testcode::</span>

<span class="sd">        from str2d import Str2D</span>

<span class="sd">        a = Str2D(&#39;a b c d\\ne f g\\nh i\\nj&#39;)</span>
<span class="sd">        a</span>

<span class="sd">    .. testoutput::</span>

<span class="sd">        a b c d</span>
<span class="sd">        e f g  </span>
<span class="sd">        h i    </span>
<span class="sd">        j      </span>

<span class="sd">    It might not be clear but the 2nd, 3rd, and 4th lines are padded with spaces to make</span>
<span class="sd">    each line the same width.  We can see this more clearly surrounding the object with</span>
<span class="sd">    a box.</span>

<span class="sd">    .. testcode::</span>

<span class="sd">        a.box()</span>

<span class="sd">    .. testoutput::</span>

<span class="sd">        ╭───────╮</span>
<span class="sd">        │a b c d│</span>
<span class="sd">        │e f g  │</span>
<span class="sd">        │h i    │</span>
<span class="sd">        │j      │</span>
<span class="sd">        ╰───────╯</span>

<span class="sd">    The padded characters are not just spaces.  The Str2D object is a structured array</span>
<span class="sd">    with two fields: &#39;char&#39; and &#39;alpha&#39;.  The &#39;char&#39; field is the character array and</span>
<span class="sd">    the &#39;alpha&#39; field is a boolean array with a of 1 or 0 for every character in the</span>
<span class="sd">    character array.  The &#39;alpha&#39; field is used to determine if a character will mask a</span>
<span class="sd">    second Str2D object when layered on top of it.  It is analogous to the alpha channel</span>
<span class="sd">    in an image where when layered on top of another image, the alpha channel will</span>
<span class="sd">    indicate which pixels will be visible and which will be transparent.  The &#39;alpha&#39;</span>
<span class="sd">    field is used in the same way.  A value of 1 means the character will be visible and</span>
<span class="sd">    a value of 0 means the character will be transparent.  The padded characters are all</span>
<span class="sd">    given an &#39;alpha&#39; value of 0.</span>

<span class="sd">    If we use the Str3D object to layer another Str2D object below it, we&#39;ll see that</span>
<span class="sd">    the padded characters will be transparent and the characters from the second Str2D</span>
<span class="sd">    object will be visible.</span>

<span class="sd">    .. testcode::</span>

<span class="sd">        from str2d import Str3D</span>

<span class="sd">        b = Str2D(&#39;&#39;&#39;\\</span>
<span class="sd">        .......</span>
<span class="sd">        .......</span>
<span class="sd">        .......</span>
<span class="sd">        .......</span>
<span class="sd">        &#39;&#39;&#39;)</span>

<span class="sd">        Str3D([a, b])</span>

<span class="sd">    .. testoutput::</span>

<span class="sd">        a b c d</span>
<span class="sd">        e f g..</span>
<span class="sd">        h i....</span>
<span class="sd">        j......</span>

<span class="sd">    We can accomplish the same thing by using the `fill_with` method. This method will</span>
<span class="sd">    fill the padded characters with the specified character.  More accurately, it will</span>
<span class="sd">    replace the characters in the &#39;char&#39; field where the &#39;alpha&#39; field is 0 with the</span>
<span class="sd">    specified character.</span>

<span class="sd">    .. testcode::</span>

<span class="sd">        a.fill_with(&#39;.&#39;)</span>

<span class="sd">    .. testoutput::</span>

<span class="sd">        a b c d</span>
<span class="sd">        e f g..</span>
<span class="sd">        h i....</span>
<span class="sd">        j......</span>

<span class="sd">    If we wanted to make all spaces transparent, we could use the `hide` method.  This</span>
<span class="sd">    will set the &#39;alpha&#39; field to 0 for all locations where the `char` field matches the</span>
<span class="sd">    specified character, which defaults to a space.</span>

<span class="sd">    .. testcode::</span>

<span class="sd">        a.hide().fill_with(&#39;.&#39;)</span>

<span class="sd">    .. testoutput::</span>

<span class="sd">        a.b.c.d</span>
<span class="sd">        e.f.g..</span>
<span class="sd">        h.i....</span>
<span class="sd">        j......</span>

<span class="sd">    Let&#39;s create a new Str2D object and assign it to the variable `c`.  This time we&#39;ll</span>
<span class="sd">    set the `halign` parameter to &#39;right&#39; which controls how lines with fewer characters</span>
<span class="sd">    than the maximum width are aligned.  By default, it is set to &#39;left&#39; which will</span>
<span class="sd">    align the lines to the left as we&#39;ve seen in the previous example with the variable</span>
<span class="sd">    `a`.</span>

<span class="sd">    .. testcode::</span>

<span class="sd">        c = Str2D(&#39;0\\n1 2\\n3 4 5\\n6 7 8 9&#39;, halign=&#39;right&#39;)</span>
<span class="sd">        c</span>

<span class="sd">    .. testoutput::</span>

<span class="sd">              0</span>
<span class="sd">            1 2</span>
<span class="sd">          3 4 5</span>
<span class="sd">        6 7 8 9</span>

<span class="sd">    We can now see our simple example of adding two Str2D objects together.</span>

<span class="sd">    .. testcode::</span>
<span class="sd">    </span>
<span class="sd">            a + c</span>

<span class="sd">    .. testoutput::</span>

<span class="sd">        a b c d      0</span>
<span class="sd">        e f g      1 2</span>
<span class="sd">        h i      3 4 5</span>
<span class="sd">        j      6 7 8 9</span>

<span class="sd">    All of the transparent characters are preserved and we can fill the result as you&#39;d</span>
<span class="sd">    expect.</span>

<span class="sd">    .. testcode::</span>

<span class="sd">        (a + c).fill_with(&#39;.&#39;)</span>

<span class="sd">    .. testoutput::</span>

<span class="sd">        a b c d......0</span>
<span class="sd">        e f g......1 2</span>
<span class="sd">        h i......3 4 5</span>
<span class="sd">        j......6 7 8 9</span>

<span class="sd">    We&#39;ll save the rest for the documentation of the individual methods.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Structured array data type for Str2D objects</span>
    <span class="c1"># the &#39;char&#39; field is the little-endian unicode single character</span>
    <span class="c1"># the &#39;alpha&#39; field is an int8 that is trying its best to be a boolean</span>
    <span class="n">_dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([(</span><span class="s2">&quot;char&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;U1&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="s2">&quot;int8&quot;</span><span class="p">)])</span>

    <span class="c1"># when doing a transpose, horizontal, or vertical transformations</span>
    <span class="c1"># shift the alignments to something that makes sense</span>
    <span class="n">_align_transpose</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="s2">&quot;middle&quot;</span><span class="p">:</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bottom&quot;</span><span class="p">:</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span>
        <span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="s2">&quot;top&quot;</span><span class="p">,</span>
        <span class="s2">&quot;center&quot;</span><span class="p">:</span> <span class="s2">&quot;middle&quot;</span><span class="p">,</span>
        <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">_align_horizontal</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="s2">&quot;left&quot;</span><span class="p">}</span>
    <span class="n">_align_vertical</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="s2">&quot;middle&quot;</span><span class="p">:</span> <span class="s2">&quot;middle&quot;</span><span class="p">,</span> <span class="s2">&quot;bottom&quot;</span><span class="p">:</span> <span class="s2">&quot;top&quot;</span><span class="p">}</span>

<div class="viewcode-block" id="Str2D.struct_pad">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.struct_pad">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">struct_pad</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;`struct_pad` pads a structured array with fields &#39;char&#39; and &#39;alpha&#39;.  The</span>
<span class="sd">        method is a wrapper around np.pad that pads the &#39;char&#39; and &#39;alpha&#39; fields with</span>
<span class="sd">        the fill value specified in the &#39;fill&#39; keyword argument.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        array : np.ndarray</span>
<span class="sd">            A structured array with fields &#39;char&#39; and &#39;alpha&#39;.</span>

<span class="sd">        fill : Tuple[str, int], optional</span>
<span class="sd">            The fill value for the &#39;char&#39; and &#39;alpha&#39; fields, by default (&#39; &#39;, 0)</span>

<span class="sd">        *args : tuple</span>
<span class="sd">            Positional arguments to np.pad.</span>

<span class="sd">        **kwargs : dict</span>
<span class="sd">            Keyword arguments to np.pad.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">            A structured array with fields &#39;char&#39; and &#39;alpha&#39; padded with the fill value</span>
<span class="sd">            specified in the &#39;fill&#39; keyword argument.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        Let&#39;s use `Str2D` to create a structured array from a string and then pad it.</span>

<span class="sd">        .. testcode::</span>

<span class="sd">            from str2d import Str2D</span>

<span class="sd">            a = Str2D(&#39;a b c d\\ne f g\\nh i\\nj&#39;)</span>
<span class="sd">            a.char</span>

<span class="sd">        .. testoutput::</span>

<span class="sd">            array([[&#39;a&#39;, &#39; &#39;, &#39;b&#39;, &#39; &#39;, &#39;c&#39;, &#39; &#39;, &#39;d&#39;],</span>
<span class="sd">                   [&#39;e&#39;, &#39; &#39;, &#39;f&#39;, &#39; &#39;, &#39;g&#39;, &#39; &#39;, &#39; &#39;],</span>
<span class="sd">                   [&#39;h&#39;, &#39; &#39;, &#39;i&#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;],</span>
<span class="sd">                   [&#39;j&#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;]], dtype=&#39;&lt;U1&#39;)</span>

<span class="sd">        Now let&#39;s pad the structured array with the fill value &#39;.&#39;.  The first argument</span>
<span class="sd">        is the data.  The next argument is the number of padding elements to add to the</span>
<span class="sd">        beginning and end of each axis.</span>

<span class="sd">        .. testcode::</span>

<span class="sd">            Str2D.struct_pad(a.data, 1, fill=(&#39;.&#39;, 0))</span>

<span class="sd">        .. testoutput::</span>

<span class="sd">            array([[&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;],</span>
<span class="sd">                    [&#39;.&#39;, &#39;a&#39;, &#39; &#39;, &#39;b&#39;, &#39; &#39;, &#39;c&#39;, &#39;d&#39;],</span>
<span class="sd">                    [&#39;.&#39;, &#39;e&#39;, &#39; &#39;, &#39;f&#39;, &#39; &#39;, &#39;g&#39;, &#39; &#39;],</span>
<span class="sd">                    [&#39;.&#39;, &#39;h&#39;, &#39; &#39;, &#39;i&#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;],</span>
<span class="sd">                    [&#39;.&#39;, &#39;j&#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;],</span>
<span class="sd">                    [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;]], dtype=&#39;&lt;U1&#39;)</span>

<span class="sd">        If we want to control the padding on each side of the array, we can pass a tuple</span>
<span class="sd">        of integers to the second argument.  The first integer is the number of padding</span>
<span class="sd">        elements to add to the beginning of each axis and the second integer is the</span>
<span class="sd">        number of padding elements to add to the end of each axis.</span>

<span class="sd">        .. testcode::</span>

<span class="sd">            Str2D.struct_pad(a.data, (1, 2), fill=(&#39;.&#39;, 0))</span>

<span class="sd">        .. testoutput::</span>

<span class="sd">            array([[&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;],</span>
<span class="sd">                   [&#39;.&#39;, &#39;a&#39;, &#39; &#39;, &#39;b&#39;, &#39; &#39;, &#39;c&#39;, &#39; &#39;, &#39;d&#39;, &#39;.&#39;, &#39;.&#39;],</span>
<span class="sd">                   [&#39;.&#39;, &#39;e&#39;, &#39; &#39;, &#39;f&#39;, &#39; &#39;, &#39;g&#39;, &#39; &#39;, &#39; &#39;, &#39;.&#39;, &#39;.&#39;],</span>
<span class="sd">                   [&#39;.&#39;, &#39;h&#39;, &#39; &#39;, &#39;i&#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39;.&#39;, &#39;.&#39;],</span>
<span class="sd">                   [&#39;.&#39;, &#39;j&#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39;.&#39;, &#39;.&#39;],</span>
<span class="sd">                   [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;],</span>
<span class="sd">                   [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;]], dtype=&#39;&lt;U1&#39;)</span>

<span class="sd">        However, you can also control the padding on each side of the array by passing</span>
<span class="sd">        the number of padding elements to add to the beginning and end of each axis as</span>
<span class="sd">        as tuple of tuples. The first tuple is the number of padding elements to add to</span>
<span class="sd">        the beginning and end of the first axis and the second tuple is the number of</span>
<span class="sd">        padding elements to add to the beginning and end of the second axis.</span>

<span class="sd">        .. testcode::</span>

<span class="sd">            Str2D.struct_pad(a.data, ((1, 3), (2, 1)), fill=(&#39;.&#39;, 0))</span>

<span class="sd">        .. testoutput::</span>

<span class="sd">            array([[&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;],</span>
<span class="sd">                   [&#39;.&#39;, &#39;.&#39;, &#39;a&#39;, &#39; &#39;, &#39;b&#39;, &#39; &#39;, &#39;c&#39;, &#39; &#39;, &#39;d&#39;, &#39;.&#39;],</span>
<span class="sd">                   [&#39;.&#39;, &#39;.&#39;, &#39;e&#39;, &#39; &#39;, &#39;f&#39;, &#39; &#39;, &#39;g&#39;, &#39; &#39;, &#39; &#39;, &#39;.&#39;],</span>
<span class="sd">                   [&#39;.&#39;, &#39;.&#39;, &#39;h&#39;, &#39; &#39;, &#39;i&#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39;.&#39;],</span>
<span class="sd">                   [&#39;.&#39;, &#39;.&#39;, &#39;j&#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39; &#39;, &#39;.&#39;],</span>
<span class="sd">                   [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;],</span>
<span class="sd">                   [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;],</span>
<span class="sd">                   [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;]], dtype=&#39;&lt;U1&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">char_fill</span><span class="p">,</span> <span class="n">alpha_fill</span> <span class="o">=</span> <span class="n">fill</span>

        <span class="n">char_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">char_mode</span> <span class="o">=</span> <span class="n">char_kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="s2">&quot;constant&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">char_mode</span> <span class="o">==</span> <span class="s2">&quot;constant&quot;</span><span class="p">:</span>
            <span class="n">char_kwargs</span><span class="p">[</span><span class="s2">&quot;constant_values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">char_fill</span>

        <span class="n">alpha_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">alpha_mode</span> <span class="o">=</span> <span class="n">alpha_kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="s2">&quot;constant&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">alpha_mode</span> <span class="o">==</span> <span class="s2">&quot;constant&quot;</span><span class="p">:</span>
            <span class="n">alpha_kwargs</span><span class="p">[</span><span class="s2">&quot;constant_values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha_fill</span>

        <span class="n">char_pad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">char_kwargs</span><span class="p">)</span>
        <span class="n">alpha_pad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">alpha_kwargs</span><span class="p">)</span>
        <span class="n">padded_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">char_pad</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_dtype</span><span class="p">)</span>
        <span class="n">padded_data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">char_pad</span>
        <span class="n">padded_data</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha_pad</span>

        <span class="k">return</span> <span class="n">padded_data</span></div>


<div class="viewcode-block" id="Str2D.validate_fill">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.validate_fill">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">validate_fill</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">fill</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate the fill value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fill : Optional[Union[str, Tuple[str, int]]], optional</span>
<span class="sd">            The fill value, by default None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Tuple[str, int]</span>
<span class="sd">            A tuple containing the fill character and fill alpha value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fill</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fill</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">fill_char</span> <span class="o">=</span> <span class="n">fill</span>
            <span class="n">fill_alpha</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fill</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">fill_char</span><span class="p">,</span> <span class="n">fill_alpha</span> <span class="o">=</span> <span class="n">fill</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;fill must be a str or tuple.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fill_char</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;fill_char must be a single character.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">fill_alpha</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">}:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;fill_alpha must be 0 or 1.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fill_char</span><span class="p">,</span> <span class="n">fill_alpha</span></div>


<div class="viewcode-block" id="Str2D.validate_halign">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.validate_halign">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">validate_halign</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">halign</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate the horizontal alignment.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        halign : str</span>
<span class="sd">            The horizontal alignment.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            The validated horizontal alignment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">halign</span> <span class="o">=</span> <span class="n">halign</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">halign</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">}:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;halign must be one of &#39;left&#39;, &#39;center&#39;, or &#39;right&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">halign</span></div>


<div class="viewcode-block" id="Str2D.validate_valign">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.validate_valign">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">validate_valign</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">valign</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate the vertical alignment.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        valign : str</span>
<span class="sd">            The vertical alignment.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            The validated vertical alignment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">valign</span> <span class="o">=</span> <span class="n">valign</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">valign</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="s2">&quot;middle&quot;</span><span class="p">,</span> <span class="s2">&quot;bottom&quot;</span><span class="p">}:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;valign must be one of &#39;top&#39;, &#39;middle&#39;, or &#39;bottom&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">valign</span></div>


<div class="viewcode-block" id="Str2D.struct_array_from_string">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.struct_array_from_string">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">struct_array_from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a structured array from a string.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        string : str</span>
<span class="sd">            A string to convert to a structured array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">            A structured array with fields &#39;char&#39; and &#39;alpha&#39; created from the input</span>
<span class="sd">              string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pre_data</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()]</span>
        <span class="c1"># needed to use `pop or 0` as opposed to `pop(key, 0)`</span>
        <span class="c1"># because `None` may have been explicitly passed</span>
        <span class="n">min_width</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;min_width&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="n">min_height</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;min_height&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="n">data_width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">pre_data</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">data_height</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pre_data</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">data_width</span><span class="p">,</span> <span class="n">min_width</span><span class="p">)</span>
        <span class="n">height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">data_height</span><span class="p">,</span> <span class="n">min_height</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_dtype</span><span class="p">)</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">data</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>

        <span class="n">halign</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;halign&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="n">valign</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;valign&quot;</span><span class="p">,</span> <span class="s2">&quot;top&quot;</span><span class="p">)</span>

        <span class="n">start_v</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">valign</span> <span class="o">==</span> <span class="s2">&quot;middle&quot;</span><span class="p">:</span>
            <span class="n">start_v</span> <span class="o">=</span> <span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="n">data_height</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">valign</span> <span class="o">==</span> <span class="s2">&quot;bottom&quot;</span><span class="p">:</span>
            <span class="n">start_v</span> <span class="o">=</span> <span class="n">height</span> <span class="o">-</span> <span class="n">data_height</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pre_data</span><span class="p">,</span> <span class="n">start_v</span><span class="p">):</span>
            <span class="n">this_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">halign</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="n">width</span> <span class="o">-</span> <span class="n">this_width</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">halign</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="n">this_width</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">start</span><span class="p">):</span>
                <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="Str2D.struct_array_from_char_array">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.struct_array_from_char_array">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">struct_array_from_char_array</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a structured array from a character array.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        array : np.ndarray</span>
<span class="sd">            A 2D character array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">            A structured array with fields &#39;char&#39; and &#39;alpha&#39; created from the input</span>
<span class="sd">              character array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_dtype</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="Str2D.struct_array_from_bool_array">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.struct_array_from_bool_array">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">struct_array_from_bool_array</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">char</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a structured array from a boolean array.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        array : np.ndarray</span>
<span class="sd">            A 2D boolean array.</span>
<span class="sd">        char : str</span>
<span class="sd">            The character to use when the boolean array is True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">            A structured array with fields &#39;char&#39; and &#39;alpha&#39; created from the input</span>
<span class="sd">              boolean array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_dtype</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="Str2D.parse">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.parse">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse the input data into a structured array.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : Optional[Any], optional</span>
<span class="sd">            The input data, by default None.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Additional keyword arguments to pass to the Str2</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">            A structured array with fields &#39;char&#39; and &#39;alpha&#39; created from the input</span>
<span class="sd">              data.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Str2D</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
                <span class="n">char</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;char&quot;</span><span class="p">,</span> <span class="s2">&quot;█&quot;</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">struct_array_from_bool_array</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">char</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_dtype</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">struct_array_from_char_array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">struct_array_from_string</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">Series</span><span class="p">)):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">struct_array_from_string</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">to_string</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;__iter__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">struct_array_from_string</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">)),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">struct_array_from_string</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">struct_array_from_string</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span></div>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">min_width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">min_height</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">halign</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="n">valign</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;top&quot;</span><span class="p">,</span>
        <span class="n">fill</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Str2D object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : Optional[Any], optional</span>
<span class="sd">            The input data, by default None.</span>
<span class="sd">        min_width : Optional[int], optional</span>
<span class="sd">            The minimum width of the output, by default None.</span>
<span class="sd">        min_height : Optional[int], optional</span>
<span class="sd">            The minimum height of the output, by default None.</span>
<span class="sd">        halign : Optional[str], optional</span>
<span class="sd">            The horizontal alignment, by default &#39;left&#39;.</span>
<span class="sd">        valign : Optional[str], optional</span>
<span class="sd">            The vertical alignment, by default &#39;top&#39;.</span>
<span class="sd">        fill : Optional[Union[str, Tuple[str, int]]], optional</span>
<span class="sd">            The fill value, by default None.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Additional keyword arguments to pass to the parse method.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the fill value is invalid.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the horizontal alignment is invalid.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the vertical alignment is invalid.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fill</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_fill</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>
        <span class="n">halign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_halign</span><span class="p">(</span><span class="n">halign</span><span class="p">)</span>
        <span class="n">valign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_valign</span><span class="p">(</span><span class="n">valign</span><span class="p">)</span>

        <span class="n">my_kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;min_width&quot;</span><span class="p">:</span> <span class="n">min_width</span><span class="p">,</span>
            <span class="s2">&quot;min_height&quot;</span><span class="p">:</span> <span class="n">min_height</span><span class="p">,</span>
            <span class="s2">&quot;halign&quot;</span><span class="p">:</span> <span class="n">halign</span><span class="p">,</span>
            <span class="s2">&quot;valign&quot;</span><span class="p">:</span> <span class="n">valign</span><span class="p">,</span>
            <span class="s2">&quot;fill&quot;</span><span class="p">:</span> <span class="n">fill</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">my_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">height_input</span><span class="p">,</span> <span class="n">width_input</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>

        <span class="n">height_data</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">height_input</span><span class="p">,</span> <span class="n">min_height</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">width_data</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">width_input</span><span class="p">,</span> <span class="n">min_width</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">width_data</span> <span class="o">-</span> <span class="n">width_input</span>
        <span class="k">if</span> <span class="n">halign</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">=</span> <span class="p">(</span><span class="n">width_data</span> <span class="o">-</span> <span class="n">width_input</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">width_data</span> <span class="o">-</span> <span class="n">width_input</span> <span class="o">-</span> <span class="n">left</span>
        <span class="k">elif</span> <span class="n">halign</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">width_data</span> <span class="o">-</span> <span class="n">width_input</span>
            <span class="n">right</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">top</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">bottom</span> <span class="o">=</span> <span class="n">height_data</span> <span class="o">-</span> <span class="n">height_input</span>
        <span class="k">if</span> <span class="n">valign</span> <span class="o">==</span> <span class="s2">&quot;middle&quot;</span><span class="p">:</span>
            <span class="n">top</span> <span class="o">=</span> <span class="p">(</span><span class="n">height_data</span> <span class="o">-</span> <span class="n">height_input</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">bottom</span> <span class="o">=</span> <span class="n">height_data</span> <span class="o">-</span> <span class="n">height_input</span> <span class="o">-</span> <span class="n">top</span>
        <span class="k">elif</span> <span class="n">valign</span> <span class="o">==</span> <span class="s2">&quot;bottom&quot;</span><span class="p">:</span>
            <span class="n">top</span> <span class="o">=</span> <span class="n">height_data</span> <span class="o">-</span> <span class="n">height_input</span>
            <span class="n">bottom</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">struct_pad</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">((</span><span class="n">top</span><span class="p">,</span> <span class="n">bottom</span><span class="p">),</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">halign</span> <span class="o">=</span> <span class="n">halign</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valign</span> <span class="o">=</span> <span class="n">valign</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">fill</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the height of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the width of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the shape of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">char</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the character data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the alpha data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the keyword arguments used to create the object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;halign&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">halign</span><span class="p">,</span>
            <span class="s2">&quot;valign&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">valign</span><span class="p">,</span>
            <span class="s2">&quot;fill&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the transpose of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
            <span class="n">halign</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_align_transpose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">valign</span><span class="p">],</span>
            <span class="n">valign</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_align_transpose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">halign</span><span class="p">],</span>
            <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the horizontal flip of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
            <span class="n">halign</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_align_horizontal</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">halign</span><span class="p">],</span>
            <span class="n">valign</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">valign</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">v</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the vertical flip of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
            <span class="n">halign</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">halign</span><span class="p">,</span>
            <span class="n">valign</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_align_vertical</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">valign</span><span class="p">],</span>
            <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">r</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the 90 degree rotation of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">h</span>

<div class="viewcode-block" id="Str2D.roll">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.roll">[docs]</a>
    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Roll the data along an axis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : int</span>
<span class="sd">            The number of positions to roll.</span>
<span class="sd">        axis : int</span>
<span class="sd">            The axis to roll along.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">            The rolled data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span>
            <span class="n">halign</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">halign</span><span class="p">,</span>
            <span class="n">valign</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">valign</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Str2D.roll_h">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.roll_h">[docs]</a>
    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">roll_h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Roll the data horizontally.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : int</span>
<span class="sd">            The number of positions to roll.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">            The rolled data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="Str2D.roll_v">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.roll_v">[docs]</a>
    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">roll_v</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Roll the data vertically.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : int</span>
<span class="sd">            The number of positions to roll.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">            The rolled data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enables convenient access to the transpose, horizontal flip, vertical flip,</span>
<span class="sd">        and rotation methods in a concatenated manner.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; s = Str2D(data=&#39;abc\ndef\nghi&#39;)</span>
<span class="sd">        &gt;&gt;&gt; s.thrvt</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">:=</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">]:</span>
            <span class="n">this</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">this</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">Str2D</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; object has no attribute &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Str2D.pad">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.pad">[docs]</a>
    <span class="k">def</span> <span class="nf">pad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;`pad` pads the data with the fill value specified in the &#39;fill&#39; keyword and</span>
<span class="sd">        is a wrapper around the class method `struct_pad` which in turn is a wrapper</span>
<span class="sd">        around np.pad.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fill : Tuple[str, int], optional</span>
<span class="sd">            The fill value for the &#39;char&#39; and &#39;alpha&#39; fields, by default (&#39; &#39;, 0)</span>

<span class="sd">        *args : tuple</span>
<span class="sd">            Positional arguments to np.pad.</span>

<span class="sd">        **kwargs : dict</span>
<span class="sd">            Keyword arguments to np.pad.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Str2D</span>
<span class="sd">            A new Str2D object with the padded data.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        Let&#39;s create an instance of Str2D and assign it to the variable `a` and then pad</span>
<span class="sd">        it.</span>

<span class="sd">        .. testcode::</span>

<span class="sd">            from str2d import Str2D</span>

<span class="sd">            a = Str2D(&#39;a b c d\\ne f g\\nh i\\nj&#39;)</span>
<span class="sd">            a</span>

<span class="sd">        .. testoutput::</span>

<span class="sd">            a b c d</span>
<span class="sd">            e f g</span>
<span class="sd">            h i</span>
<span class="sd">            j</span>

<span class="sd">        Now let&#39;s pad the structured array with the fill value &#39;.&#39;.  The first argument</span>
<span class="sd">        is the number of padding elements to add to the beginning and end of each axis.</span>

<span class="sd">        .. testcode::</span>

<span class="sd">            a.pad(1, fill=(&#39;.&#39;, 0))</span>

<span class="sd">        .. testoutput::</span>

<span class="sd">            .........</span>
<span class="sd">            .a b c d.</span>
<span class="sd">            .e f g  .</span>
<span class="sd">            .h i    .</span>
<span class="sd">            .j      .</span>
<span class="sd">            .........</span>

<span class="sd">        If we want to control the padding on each side, we can pass a tuple of integers</span>
<span class="sd">        to the first argument.  The first integer is the number of padding elements to</span>
<span class="sd">        add to the beginning of each axis and the second integer is the number of</span>
<span class="sd">        padding elements to add to the end of each axis.</span>

<span class="sd">        .. testcode::</span>

<span class="sd">            a.pad((1, 2), fill=(&#39;.&#39;, 0))</span>

<span class="sd">        .. testoutput::</span>

<span class="sd">            ..........</span>
<span class="sd">            .a b c d..</span>
<span class="sd">            .e f g  ..</span>
<span class="sd">            .h i    ..</span>
<span class="sd">            .j      ..</span>
<span class="sd">            ..........</span>
<span class="sd">            ..........</span>

<span class="sd">        However, you can also control the padding on each side of the array by passing</span>
<span class="sd">        the number of padding elements to add to the beginning and end of each axis as</span>
<span class="sd">        as tuple of tuples. The first tuple is the number of padding elements to add to</span>
<span class="sd">        the beginning and end of the first axis and the second tuple is the number of</span>
<span class="sd">        padding elements to add to the beginning and end of the second axis.</span>

<span class="sd">        .. testcode::</span>

<span class="sd">            a.pad(((1, 3), (2, 1)), fill=(&#39;.&#39;, 0))</span>

<span class="sd">        .. testoutput::</span>

<span class="sd">            ..........</span>
<span class="sd">            ..a b c d.</span>
<span class="sd">            ..e f g  .</span>
<span class="sd">            ..h i    .</span>
<span class="sd">            ..j      .</span>
<span class="sd">            ..........</span>
<span class="sd">            ..........</span>
<span class="sd">            ..........</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">)</span>
        <span class="n">padded_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">struct_pad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">padded_data</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Str2D.expand">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.expand">[docs]</a>
    <span class="k">def</span> <span class="nf">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Expand the data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : int, optional</span>
<span class="sd">            The number of columns to expand, by default 0.</span>
<span class="sd">        y : int, optional</span>
<span class="sd">            The number of rows to expand, by default 0.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Additional keyword arguments to pass to the pad method.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">            The expanded data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">top</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">halign</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">x</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">halign</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">valign</span> <span class="o">==</span> <span class="s2">&quot;middle&quot;</span><span class="p">:</span>
            <span class="n">top</span> <span class="o">=</span> <span class="n">y</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">valign</span> <span class="o">==</span> <span class="s2">&quot;bottom&quot;</span><span class="p">:</span>
            <span class="n">top</span> <span class="o">=</span> <span class="n">y</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">left</span>
        <span class="n">bottom</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">top</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span><span class="p">(((</span><span class="n">top</span><span class="p">,</span> <span class="n">bottom</span><span class="p">),</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Str2D.split">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.split">[docs]</a>
    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Str2D&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Split the data along an axis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis : int</span>
<span class="sd">            The axis to split along.</span>
<span class="sd">        *args : int</span>
<span class="sd">            The indices to pass to np.split.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List[Str2D]</span>
<span class="sd">            A list of the split data.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indices_or_sections</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">split</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">indices_or_sections</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
        <span class="p">]</span></div>


    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">slice</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">slice</span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">slice</span><span class="p">]]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the data at the specified indices.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">new_key</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(([</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">else</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
            <span class="n">new_key</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_key</span> <span class="o">=</span> <span class="n">key</span>

        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">new_key</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Str2D.join_h">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.join_h">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">join_h</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Join the data horizontally.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">sep</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">sep</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="n">args</span><span class="p">),</span> <span class="p">())[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span></div>


<div class="viewcode-block" id="Str2D.join_v">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.join_v">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">join_v</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Join the data vertically.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">sep</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">sep</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="n">args</span><span class="p">),</span> <span class="p">())[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">/</span> <span class="n">y</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span></div>


<div class="viewcode-block" id="Str2D.equal_height">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.equal_height">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">equal_height</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Make the data have equal height.&quot;&quot;&quot;</span>
        <span class="n">max_height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">height</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">max_height</span> <span class="o">-</span> <span class="n">arg</span><span class="o">.</span><span class="n">height</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span></div>


<div class="viewcode-block" id="Str2D.equal_width">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.equal_width">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">equal_width</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Make the data have equal width.&quot;&quot;&quot;</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">width</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">max_width</span> <span class="o">-</span> <span class="n">arg</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span></div>


<div class="viewcode-block" id="Str2D.equal_shape">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.equal_shape">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">equal_shape</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Make the data have equal shape.&quot;&quot;&quot;</span>
        <span class="n">max_height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">height</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">width</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">arg</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">max_width</span> <span class="o">-</span> <span class="n">arg</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">max_height</span> <span class="o">-</span> <span class="n">arg</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span>
        <span class="p">]</span></div>


    <span class="c1"># math operations</span>
    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">,</span> <span class="n">right_side</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add the data.&quot;&quot;&quot;</span>
        <span class="n">other_expand_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">other_expand_kwargs</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;edge&quot;</span>
            <span class="k">if</span> <span class="n">other</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">other_expand_kwargs</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">other</span><span class="p">)</span>

        <span class="n">height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="n">left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">height</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">height</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="o">**</span><span class="n">other_expand_kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">right_side</span><span class="p">:</span>
            <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">right</span><span class="p">,</span> <span class="n">left</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">left</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">right</span><span class="o">.</span><span class="n">data</span><span class="p">)),</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">right_side</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<div class="viewcode-block" id="Str2D.add">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.add">[docs]</a>
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="o">.</span><span class="n">join_h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Multiply the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span> <span class="o">*</span> <span class="n">other</span><span class="p">),</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Multiply the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span> <span class="o">*</span> <span class="n">other</span><span class="p">),</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">,</span> <span class="n">right_side</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Divide the data.&quot;&quot;&quot;</span>
        <span class="n">other_expand_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">other_expand_kwargs</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;edge&quot;</span>
            <span class="k">if</span> <span class="n">other</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">other_expand_kwargs</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">other</span><span class="p">)</span>

        <span class="n">width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        <span class="n">left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">width</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">width</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="o">**</span><span class="n">other_expand_kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">right_side</span><span class="p">:</span>
            <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">right</span><span class="p">,</span> <span class="n">left</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">left</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">right</span><span class="o">.</span><span class="n">data</span><span class="p">)),</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Divide the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__truediv__</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">right_side</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<div class="viewcode-block" id="Str2D.circle">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.circle">[docs]</a>
    <span class="k">def</span> <span class="nf">circle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">char</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a circle.&quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">circle</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">char</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Str3D</span><span class="p">([</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="p">])</span></div>


<div class="viewcode-block" id="Str2D.hole">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.hole">[docs]</a>
    <span class="k">def</span> <span class="nf">hole</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">char</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a hole.&quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">hole</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">char</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Str3D</span><span class="p">([</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="p">])</span></div>


<div class="viewcode-block" id="Str2D.box_over">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.box_over">[docs]</a>
    <span class="k">def</span> <span class="nf">box_over</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a box over the data.&quot;&quot;&quot;</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">Box</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">2</span><span class="p">],</span> <span class="n">style</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Str3D</span><span class="p">([</span><span class="n">box</span><span class="p">,</span> <span class="bp">self</span><span class="p">])</span></div>


<div class="viewcode-block" id="Str2D.box_around">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.box_around">[docs]</a>
    <span class="k">def</span> <span class="nf">box_around</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a box around the data.&quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span><span class="p">(((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">Box</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">],</span> <span class="n">style</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Str3D</span><span class="p">([</span><span class="n">box</span><span class="p">,</span> <span class="n">s</span><span class="p">])</span></div>


<div class="viewcode-block" id="Str2D.box">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.box">[docs]</a>
    <span class="k">def</span> <span class="nf">box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;single_round&quot;</span><span class="p">,</span> <span class="n">around</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a box around the data.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">around</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">box_around</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">box_over</span><span class="p">(</span><span class="n">style</span><span class="p">)</span></div>


<div class="viewcode-block" id="Str2D.pi">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.pi">[docs]</a>
    <span class="k">def</span> <span class="nf">pi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Replace the data with pi.&quot;&quot;&quot;</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()</span>
        <span class="n">old_dps</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">mp</span><span class="o">.</span><span class="n">dps</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">mp</span><span class="o">.</span><span class="n">mp</span><span class="o">.</span><span class="n">dps</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">str</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">pi</span><span class="p">)][:</span><span class="n">n</span><span class="p">]</span>
        <span class="n">mp</span><span class="o">.</span><span class="n">mp</span><span class="o">.</span><span class="n">dps</span> <span class="o">=</span> <span class="n">old_dps</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="Str2D.hide">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.hide">[docs]</a>
    <span class="k">def</span> <span class="nf">hide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Hide the data.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">char</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Str2D.div">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.div">[docs]</a>
    <span class="k">def</span> <span class="nf">div</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Divide the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="o">.</span><span class="n">join_v</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the string representation of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the string representation of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># string operation methods that return a new Str2D object</span>
    <span class="c1"># ... and whose result is a new character array</span>
<div class="viewcode-block" id="Str2D.lower">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.lower">[docs]</a>
    <span class="k">def</span> <span class="nf">lower</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the lowercase version of the data.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Str2D.upper">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.upper">[docs]</a>
    <span class="k">def</span> <span class="nf">upper</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the uppercase version of the data.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">upper</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Str2D.replace">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.replace">[docs]</a>
    <span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Replace the data.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">],</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Str2D.title">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.title">[docs]</a>
    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the title version of the data.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">char</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Str2D.strip">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.strip">[docs]</a>
    <span class="k">def</span> <span class="nf">strip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the stripped version of the data.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">char</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">char</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Str2D.lstrip">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.lstrip">[docs]</a>
    <span class="k">def</span> <span class="nf">lstrip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the left stripped version of the data.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">char</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">char</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Str2D.rstrip">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.rstrip">[docs]</a>
    <span class="k">def</span> <span class="nf">rstrip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the right stripped version of the data.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">char</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">char</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="c1"># string operation methods that return a new Str2D object</span>
    <span class="c1"># ... and whose result is a new boolean array</span>
<div class="viewcode-block" id="Str2D.isdigit">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.isdigit">[docs]</a>
    <span class="k">def</span> <span class="nf">isdigit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return whether the data is a digit.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">isdigit</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int8&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return whether the data is equal to the other data.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="n">other</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Str2D</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;other must be a Str2D object or a scalar.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return whether the data is not equal to the other data.&quot;&quot;&quot;</span>
        <span class="n">eq</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">other</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="n">eq</span>
        <span class="k">return</span> <span class="o">~</span><span class="n">eq</span>

<div class="viewcode-block" id="Str2D.strip2d">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.strip2d">[docs]</a>
    <span class="k">def</span> <span class="nf">strip2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Strip the data.&quot;&quot;&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">!=</span> <span class="n">char</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">x0</span> <span class="p">:</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y0</span> <span class="p">:</span> <span class="n">y1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></div>


<div class="viewcode-block" id="Str2D.fill_with">
<a class="viewcode-back" href="../str2d.html#str2d.Str2D.fill_with">[docs]</a>
    <span class="k">def</span> <span class="nf">fill_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str2D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fill the data with a character.&quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fill&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;char&quot;</span><span class="p">],</span> <span class="n">char</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
</div>



<span class="k">class</span> <span class="nc">Box</span><span class="p">(</span><span class="n">Str2D</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a box around the data.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Box.spec_to_positions">
<a class="viewcode-back" href="../str2d.html#str2d.Box.spec_to_positions">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">spec_to_positions</span><span class="p">(</span><span class="n">spec</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a specification to positions.&quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">))</span></div>


<div class="viewcode-block" id="Box.spec_to_len">
<a class="viewcode-back" href="../str2d.html#str2d.Box.spec_to_len">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">spec_to_len</span><span class="p">(</span><span class="n">spec</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a specification to length.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span></div>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">spec_v</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">spec_h</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">style</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BoxStyle</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">BoxStyle</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Str2D</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a box around the data.&quot;&quot;&quot;</span>

        <span class="n">spec_v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">spec_v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">spec_v</span>
        <span class="n">spec_h</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">spec_h</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">spec_h</span>
        <span class="n">pos_v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spec_to_positions</span><span class="p">(</span><span class="n">spec_v</span><span class="p">)</span>
        <span class="n">pos_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spec_to_positions</span><span class="p">(</span><span class="n">spec_h</span><span class="p">)</span>
        <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spec_to_len</span><span class="p">(</span><span class="n">spec_v</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spec_to_len</span><span class="p">(</span><span class="n">spec_h</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">style</span> <span class="o">=</span> <span class="n">BoxStyle</span><span class="p">[</span><span class="n">style</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>
        <span class="n">chars</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">value</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">spec_v</span> <span class="o">=</span> <span class="n">spec_v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spec_h</span> <span class="o">=</span> <span class="n">spec_h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">style</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos_v</span> <span class="o">=</span> <span class="n">pos_v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos_h</span> <span class="o">=</span> <span class="n">pos_h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chars</span> <span class="o">=</span> <span class="n">chars</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Str2D</span><span class="o">.</span><span class="n">_dtype</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assign_box_char</span><span class="p">()</span>

<div class="viewcode-block" id="Box.assign_box_char">
<a class="viewcode-back" href="../str2d.html#str2d.Box.assign_box_char">[docs]</a>
    <span class="k">def</span> <span class="nf">assign_box_char</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assign the box characters.&quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        <span class="n">pos_v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_v</span>
        <span class="n">pos_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_h</span>
        <span class="n">chars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chars</span>

        <span class="n">data</span><span class="p">[:,</span> <span class="n">pos_h</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">chars</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="n">pos_v</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">chars</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">pos_h</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">chars</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos_h</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">chars</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">data</span><span class="p">[</span><span class="n">pos_v</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">chars</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="n">pos_v</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">chars</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">pos_v</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">pos_h</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span> <span class="o">=</span> <span class="p">(</span><span class="n">chars</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">pos_v_corners</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">pos_h_corners</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">corners</span> <span class="o">=</span> <span class="p">[[(</span><span class="n">chars</span><span class="o">.</span><span class="n">ul</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">chars</span><span class="o">.</span><span class="n">ur</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">[(</span><span class="n">chars</span><span class="o">.</span><span class="n">ll</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">chars</span><span class="o">.</span><span class="n">lr</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]]</span>
        <span class="n">data</span><span class="p">[</span><span class="n">pos_v_corners</span><span class="p">,</span> <span class="n">pos_h_corners</span><span class="p">]</span> <span class="o">=</span> <span class="n">corners</span>

        <span class="k">return</span> <span class="bp">self</span></div>


    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the transpose of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Box</span><span class="p">(</span><span class="n">spec_v</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spec_h</span><span class="p">,</span> <span class="n">spec_h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spec_v</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">)</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the horizontal flip of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Box</span><span class="p">(</span><span class="n">spec_v</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spec_v</span><span class="p">,</span> <span class="n">spec_h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spec_h</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">)</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">v</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the vertical flip of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Box</span><span class="p">(</span><span class="n">spec_v</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spec_v</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">spec_h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spec_h</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">)</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">r</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the 90 degree rotation of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">h</span>


<div class="viewcode-block" id="Str3D">
<a class="viewcode-back" href="../str2d.html#str2d.Str3D">[docs]</a>
<span class="k">class</span> <span class="nc">Str3D</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manipulate 3D strings in Python.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Str3D object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">datum</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">datum</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>

<div class="viewcode-block" id="Str3D.update">
<a class="viewcode-back" href="../str2d.html#str2d.Str3D.update">[docs]</a>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the data.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">datum</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">datum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">])</span></div>


    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the string representation of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the string representation of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the transpose of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Str3D</span><span class="p">([</span><span class="n">datum</span><span class="o">.</span><span class="n">t</span> <span class="k">for</span> <span class="n">datum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">])</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the horizontal flip of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Str3D</span><span class="p">([</span><span class="n">datum</span><span class="o">.</span><span class="n">h</span> <span class="k">for</span> <span class="n">datum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">])</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">v</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the vertical flip of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Str3D</span><span class="p">([</span><span class="n">datum</span><span class="o">.</span><span class="n">v</span> <span class="k">for</span> <span class="n">datum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">])</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">r</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the 90 degree rotation of the data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">h</span>

<div class="viewcode-block" id="Str3D.roll">
<a class="viewcode-back" href="../str2d.html#str2d.Str3D.roll">[docs]</a>
    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Str3D&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Roll the data along an axis.&quot;&quot;&quot;</span>

        <span class="n">layer</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;layer&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">layer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Str3D</span><span class="p">([</span><span class="n">datum</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">datum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">layer</span><span class="p">):</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="p">[</span><span class="n">layer</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">Str3D</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">datum</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">layer</span> <span class="k">else</span> <span class="n">datum</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">datum</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the view of the data.&quot;&quot;&quot;</span>
        <span class="n">argmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">y_indices</span><span class="p">,</span> <span class="n">x_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ogrid</span><span class="p">[:</span><span class="n">height</span><span class="p">,</span> <span class="p">:</span><span class="n">width</span><span class="p">]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">argmax</span><span class="p">,</span> <span class="n">y_indices</span><span class="p">,</span> <span class="n">x_indices</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enables convenient access to the transpose, horizontal flip, vertical flip,</span>
<span class="sd">        and rotation methods in a concatenated manner.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">Str3D</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; object has no attribute &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="space">
<a class="viewcode-back" href="../str2d.html#str2d.space">[docs]</a>
<span class="k">def</span> <span class="nf">space</span><span class="p">(</span><span class="n">mn</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a space.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">w</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">w</span><span class="si">=}</span><span class="s2"> must be &gt;= 1&quot;</span><span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mn</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">a</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span></div>



<div class="viewcode-block" id="region">
<a class="viewcode-back" href="../str2d.html#str2d.region">[docs]</a>
<span class="k">def</span> <span class="nf">region</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a region.&quot;&quot;&quot;</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">space</span><span class="p">(</span><span class="o">*</span><span class="n">x_range</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">middle</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">space</span><span class="p">(</span><span class="o">*</span><span class="n">y_range</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">height</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">center</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">middle</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span></div>



<div class="viewcode-block" id="boundary">
<a class="viewcode-back" href="../str2d.html#str2d.boundary">[docs]</a>
<span class="k">def</span> <span class="nf">boundary</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a boundary.&quot;&quot;&quot;</span>
    <span class="n">left</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">space</span><span class="p">(</span><span class="o">*</span><span class="n">x_range</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
    <span class="n">bottom</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="n">space</span><span class="p">(</span><span class="o">*</span><span class="n">y_range</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">height</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">func</span><span class="p">(</span><span class="n">left</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:],</span> <span class="n">top</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]),</span>
            <span class="n">func</span><span class="p">(</span><span class="n">right</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:],</span> <span class="n">top</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]),</span>
            <span class="n">func</span><span class="p">(</span><span class="n">right</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:],</span> <span class="n">bottom</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]),</span>
            <span class="n">func</span><span class="p">(</span><span class="n">left</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:],</span> <span class="n">bottom</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]),</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">mask</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>



<div class="viewcode-block" id="circle">
<a class="viewcode-back" href="../str2d.html#str2d.circle">[docs]</a>
<span class="k">def</span> <span class="nf">circle</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">char</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a circle.&quot;&quot;&quot;</span>
    <span class="n">height_limited</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">width</span> <span class="o">&lt;</span> <span class="n">height</span> <span class="o">*</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">height_limited</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">height_limited</span><span class="p">:</span>
        <span class="n">y_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">x_range</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y_range</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">y_range</span> <span class="o">=</span> <span class="n">height</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">width</span> <span class="o">*</span> <span class="n">x_range</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">boundary</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">radius</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">char</span><span class="o">=</span><span class="n">char</span><span class="p">)</span></div>



<div class="viewcode-block" id="hole">
<a class="viewcode-back" href="../str2d.html#str2d.hole">[docs]</a>
<span class="k">def</span> <span class="nf">hole</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">char</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a hole.&quot;&quot;&quot;</span>
    <span class="n">height_limited</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">width</span> <span class="o">&lt;</span> <span class="n">height</span> <span class="o">*</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">height_limited</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">height_limited</span><span class="p">:</span>
        <span class="n">y_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">x_range</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y_range</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">y_range</span> <span class="o">=</span> <span class="n">height</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">width</span> <span class="o">*</span> <span class="n">x_range</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">region</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">Str2D</span><span class="p">(</span><span class="o">~</span><span class="n">mask</span><span class="p">,</span> <span class="n">char</span><span class="o">=</span><span class="n">char</span><span class="p">)</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Sean Smith.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>